<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <meta http-equiv="content-language" content="en" />
   <meta name="description" content="Phrack staff website." />
   <meta name="keywords" content="phrack" />
   <meta name="robots" content="follow,index,all" />

   <meta name="revisit-after" content="7 days" />
   
   <title>.:: Phrack Magazine ::.</title>
   
   <link href="../../css/style.css" rel="stylesheet" type="text/css">
</head>
<body id="top">
<div align="center" class="texto-2-bold">
[ <a href="../../index.html" title="News">News</a> ]
[ <a href="../../" title="Paper Feed">Paper Feed</a> ]
[ <a href="../../issues/71/1.html" title="Issues">Issues</a> ]
[ <a href="../../authors.html" title="Authors">Authors</a> ]
[ <a href="../../archives/" title="Archives">Archives</a> ]
[ <a href="../../contact.html" title="Contact">Contact</a> ]

</div>

<center>
   <br>
   <br>
   <img width="600" src="../../images/phrack-logo.jpg" alt="..[ Phrack Magazine ]..">
   <br>

   <div class="texto-2">
   <div class="p-title">.:: VAX/VMS Fake Mail ::.</div>
   <hr width="600" />
   </div>
   
   <div style="padding-top: 4px; padding-bottom: 4px;">
<div class="around">

<div class="details"><strong>Issues</strong>: 
[ <a href="../../issues/1/1.html" title="Issue 1">1</a> ] [ <a href="../../issues/2/1.html" title="Issue 2">2</a> ] [ <a href="../../issues/3/1.html" title="Issue 3">3</a> ] [ <a href="../../issues/4/1.html" title="Issue 4">4</a> ] [ <a href="../../issues/5/1.html" title="Issue 5">5</a> ] [ <a href="../../issues/6/1.html" title="Issue 6">6</a> ] [ <a href="../../issues/7/1.html" title="Issue 7">7</a> ] [ <a href="../../issues/8/1.html" title="Issue 8">8</a> ] [ <a href="../../issues/9/1.html" title="Issue 9">9</a> ] [ <a href="../../issues/10/1.html" title="Issue 10">10</a> ] [ <a href="../../issues/11/1.html" title="Issue 11">11</a> ] [ <a href="../../issues/12/1.html" title="Issue 12">12</a> ] [ <a href="../../issues/13/1.html" title="Issue 13">13</a> ] [ <a href="../../issues/14/1.html" title="Issue 14">14</a> ] [ <a href="../../issues/15/1.html" title="Issue 15">15</a> ] [ <a href="../../issues/16/1.html" title="Issue 16">16</a> ] [ <a href="../../issues/17/1.html" title="Issue 17">17</a> ] [ <a href="../../issues/18/1.html" title="Issue 18">18</a> ] [ <a href="../../issues/19/1.html" title="Issue 19">19</a> ] [ <a href="../../issues/20/1.html" title="Issue 20">20</a> ] [ <a href="../../issues/21/1.html" title="Issue 21">21</a> ] [ <a href="../../issues/22/1.html" title="Issue 22">22</a> ] [ <a href="../../issues/23/1.html" title="Issue 23">23</a> ] [ <a href="../../issues/24/1.html" title="Issue 24">24</a> ] [ <a href="../../issues/25/1.html" title="Issue 25">25</a> ] [ <a href="../../issues/26/1.html" title="Issue 26">26</a> ] [ <a href="../../issues/27/1.html" title="Issue 27">27</a> ] [ <a href="../../issues/28/1.html" title="Issue 28">28</a> ] [ <a href="../../issues/29/1.html" title="Issue 29">29</a> ] [ <a class="current" href="../../issues/30/1.html" title="Issue 30">30</a> ] [ <a href="../../issues/31/1.html" title="Issue 31">31</a> ] [ <a href="../../issues/32/1.html" title="Issue 32">32</a> ] [ <a href="../../issues/33/1.html" title="Issue 33">33</a> ] [ <a href="../../issues/34/1.html" title="Issue 34">34</a> ] [ <a href="../../issues/35/1.html" title="Issue 35">35</a> ] [ <a href="../../issues/36/1.html" title="Issue 36">36</a> ] [ <a href="../../issues/37/1.html" title="Issue 37">37</a> ] [ <a href="../../issues/38/1.html" title="Issue 38">38</a> ] [ <a href="../../issues/39/1.html" title="Issue 39">39</a> ] [ <a href="../../issues/40/1.html" title="Issue 40">40</a> ] [ <a href="../../issues/41/1.html" title="Issue 41">41</a> ] [ <a href="../../issues/42/1.html" title="Issue 42">42</a> ] [ <a href="../../issues/43/1.html" title="Issue 43">43</a> ] [ <a href="../../issues/44/1.html" title="Issue 44">44</a> ] [ <a href="../../issues/45/1.html" title="Issue 45">45</a> ] [ <a href="../../issues/46/1.html" title="Issue 46">46</a> ] [ <a href="../../issues/47/1.html" title="Issue 47">47</a> ] [ <a href="../../issues/48/1.html" title="Issue 48">48</a> ] [ <a href="../../issues/49/1.html" title="Issue 49">49</a> ] [ <a href="../../issues/50/1.html" title="Issue 50">50</a> ] [ <a href="../../issues/51/1.html" title="Issue 51">51</a> ] [ <a href="../../issues/52/1.html" title="Issue 52">52</a> ] [ <a href="../../issues/53/1.html" title="Issue 53">53</a> ] [ <a href="../../issues/54/1.html" title="Issue 54">54</a> ] [ <a href="../../issues/55/1.html" title="Issue 55">55</a> ] [ <a href="../../issues/56/1.html" title="Issue 56">56</a> ] [ <a href="../../issues/57/1.html" title="Issue 57">57</a> ] [ <a href="../../issues/58/1.html" title="Issue 58">58</a> ] [ <a href="../../issues/59/1.html" title="Issue 59">59</a> ] [ <a href="../../issues/60/1.html" title="Issue 60">60</a> ] [ <a href="../../issues/61/1.html" title="Issue 61">61</a> ] [ <a href="../../issues/62/1.html" title="Issue 62">62</a> ] [ <a href="../../issues/63/1.html" title="Issue 63">63</a> ] [ <a href="../../issues/64/1.html" title="Issue 64">64</a> ] [ <a href="../../issues/65/1.html" title="Issue 65">65</a> ] [ <a href="../../issues/66/1.html" title="Issue 66">66</a> ] [ <a href="../../issues/67/1.html" title="Issue 67">67</a> ] [ <a href="../../issues/68/1.html" title="Issue 68">68</a> ] [ <a href="../../issues/69/1.html" title="Issue 69">69</a> ] [ <a href="../../issues/70/1.html" title="Issue 70">70</a> ] [ <a href="../../issues/71/1.html" title="Issue 71">71</a> ] 
</div>
<div class="opt" align="center"><div class="rt"><a href="../../archives/tgz/phrack30.tar.gz" title="Get current issue tar.gz">Get tar.gz</a></div><strong>Current issue</strong> : #<a href="../../archives/tgz/phrack30.tar.gz" title="Get current issue tar.gz">30</a> | <strong>Release date</strong> : <b>1989-12-24</b> | <strong>Editor</strong> : <b>Taran King</b></div>

<div style="border-top: 1px solid black; border-bottom: 2px solid black">
<table class="tissue" cellpadding="0" cellspacing="0">
   <tbody>
      <tr><td align="left"><a href="../../issues/30/1.html#article">Phrack Inc. XXX Index</a></td><td align="right">Knight Lightning &amp; Taran King</td></tr>
<tr><td align="left"><a href="../../issues/30/2.html#article">Network Miscellany III</a></td><td align="right">Taran King</td></tr>
<tr><td align="left"><a href="../../issues/30/3.html#article">Hacking &amp; Tymnet</a></td><td align="right">Synthecide</td></tr>
<tr><td align="left"><a href="../../issues/30/4.html#article">Hacking VM/CMS</a></td><td align="right">Goe</td></tr>
<tr><td align="left"><a href="../../issues/30/5.html#article">The DECWRL Mail Gateway</a></td><td align="right">Dedicated Link</td></tr>
<tr><td align="left"><a href="../../issues/30/6.html#article">Decnet Hackola : Remote Turist TTY (RTT)</a></td><td align="right">Hobbit</td></tr>
<tr><td align="left"><a href="../../issues/30/7.html#article">VAX/VMS Fake Mail</a></td><td align="right">Jack T. Tab</td></tr>
<tr><td align="left"><a href="../../issues/30/8.html#article">Consensual Realities in Cyberspace</a></td><td align="right">Paul Saffo</td></tr>
<tr><td align="left"><a href="../../issues/30/9.html#article">The Truth About Lie Detectors</a></td><td align="right">Razor's Edge</td></tr>
<tr><td align="left"><a href="../../issues/30/10.html#article">Western Union Telex, TWX, and Time Service</a></td><td align="right">Phone Phanatic</td></tr>
<tr><td align="left"><a href="../../issues/30/11.html#article">Phrack World News XXX Part 1</a></td><td align="right">Knight Lightning</td></tr>
<tr><td align="left"><a href="../../issues/30/12.html#article">Phrack World News XXX Part 2</a></td><td align="right">Knight Lightning</td></tr>

   </tbody>
</table>

<div class="opt" id="article"><strong>Title</strong> : VAX/VMS Fake Mail</div>
<div class="opt-bottom"> <strong>Author</strong> : Jack T. Tab</div>
<pre>                                ==Phrack Inc.=

                     Volume Three, Issue 30, File #7 of 12

                             =-------------------=

                               VAX/VMS Fake Mail

                                by Jack T. Tab

                             =-------------------=


In the August 1986 issue of VAX PROFESSIONAL, the BASIC subroutine that appears
at the end of this text was published.  It was not until more than two years
later that DEC included a callable mail interface with VMS 5.x.  While the
official version is much more extensive, the routine included here has one
important feature.  The ability to have a mail message appear to be from
someone else is a good addition to most &quot;toolkits.&quot;

VMS Mail works in two manners.  The first is the familiar interactive.  The
second is as a network object.  In this method, MAIL is invoked by the
NETSERVER.COM command procedure in response to an incoming connect request.
MAIL.EXE is activated as network object 27.  The other network objects can be
viewed by using the NCP command SHOW KNOWN OBJECTS.  In this mode, MAIL.EXE
operates as a slave process, receiving instructions from the master process.
The master, in most cases, is another process running MAIL.EXE interactively.
The slave process can handle requests to deliver mail to as many recipients as
necessary.  Addresses that are not on the same node as the slave process are
forwarded by activating yet another slave process on the target node.  The
information sent by the master MAIL to the slave MAIL is quite simple and
straightforward, consisting of a series of strings.

The first string is for the FROM name.  This is what makes the subroutine
useful, as it can be anything (i.e. the_Easter_Bunny).  The next set of strings
are to whom the mail is to be sent.  One address per string, with a null
string, chr(0), terminating the list.  The third item is what the receiver(s)
sees in their TO: field.  This also can be anything.  VMS MAIL can use this
option for its .DIS distribution lists.  The final information is the body of
the message.  It too is terminated by another null string.  The subject of the
mail message is taken from the first line of this text.

The MAIL slave will send back appropriate status messages indicating problems
if they occur.  Such as &quot;Addressee Unknown&quot; or VMS and DECnet errors like &quot;Disk
Quota Exceeded&quot; or &quot;Remote Node Not Reachable&quot;).

The only privilege that seems necessary is NETMBX.  Without it the subroutine
cannot call MAIL as a network object.  Our beloved system management resolved
the problem of people pretending to be SYSTEM by installing MAIL with NETMBX
and removing the priv from the student accounts.  The subroutine works just as
well with JNET and BITNET as it does with DECNET addresses.


***********************************CUT HERE************************************
1  %TITLE 'MAIL SUBROUTINE'

   SUB MAILT( STRING NODE, &amp;
       STRING FROM_NAME, &amp;
       STRING TO_LIST(), &amp;
       STRING TO_SHOW, &amp;
       STRING SUBJECT, &amp;
       STRING TEXT() )

   OPTION TYPE = INTEGER

   DECLARE INTEGER FUNCTION &amp;
     PUT_MSG

   DECLARE STRING FUNCTION &amp;
     GET_MSG, &amp;
     GET_INPUT

   DECLARE INTEGER CONSTANT &amp;
     TRUE = -1, &amp;
     FALSE = 0
   Net_Link_Open = FALSE

   Z = POS( NODE + &quot;:&quot; , &quot;:&quot; , 1)
   NODE_NAME$ = LEFT$( NODE , Z - 1 )
   ON ERROR GOTO Mail_Net_Error
   MAIL_CHANNEL = 12
   OPEN NODE_NAME$ + '::&quot;27=&quot;' AS FILE MAIL_CHANNEL

   Net_Link_Open = TRUE

   STS = PUT_MSG( FROM_NAME )
   IF STS &lt;&gt; 0 THEN
     GOTO ERROR_DONE
   END IF
   RECEIVERS = 0
   TO_COUNT = 1

Mail_Recipients:
   IF TO_LIST( TO_COUNT ) = &quot;&quot; THEN
     GOTO End_Of_Line
   END IF
   STS = PUT_MSG( EDIT$( TO_LIST( TO_COUNT ) , 32 ) )
   IF STS &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF
   GOSUB Errchk
   IF LINK_ERR &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF

   IF ( ERRSTS AND 1 ) = 0 THEN
     GOTO Error_Done
   END IF

   TO_COUNT = TO_COUNT + 1
   GOTO Mail_Recipients

END_OF_LINE:
   STS = PUT_MSG( CHR$(0) )
   IF STS &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF
   IF RECEIVERS = 0 THEN
     GOTO Mail_Done
   END IF

   STS = PUT_MSG( TO_SHOW )
   IF STS &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF

   STS = PUT_MSG( SUBJECT )
   IF STS &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF

   FOR I = 1 UNTIL TEXT(I) = CHR$(255)
     STS = PUT_MSG( TEXT(I) )
     IF STS &lt;&gt; 0 THEN
       GOTO Error_Done
     END IF
   NEXT I

   STS = PUT_MSG( CHR$(0) )
   IF STS &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF
   SAVE_COUNT = RECEIVERS
   INDEX = 0

Delivery_Check:
   GOSUB Errchk
   IF LINK_ERR &lt;&gt; 0 THEN
     GOTO Error_Done
   END IF
   INDEX = INDEX + 1
   IF INDEX &lt;&gt; SAVE_COUNT THEN
     GOTO Delivery_Check
   END IF
   GOTO Mail_Done

Errchk:
   MAIL_STS = ASCII( GET_MSG )
   IF LINK_ERR &lt;&gt; 0 THEN
     ERRSTS = LINK_ERR
     RETURN
   END IF
   IF ( MAIL_STS AND 1 ) = 1 THEN
     Receivers = Receivers + 1
     ERRSTS = MAIL_STS
     RETURN
   END IF

Errmsg:
   MAIL_ERR$ = GET_MSG
   IF LINK_ERR &lt;&gt; 0 THEN
     ERRSTS = LINK_ERR
     RETURN
   END IF
   IF LEN( MAIL_ERR$ ) &lt;&gt; 1 THEN
     PRINT MAIL_ERR$
     GOTO Errmsg
   END IF
   IF ASCII( MAIL_ERR$ ) = 0 THEN
     RETURN
   ELSE
     GOTO Errmsg
   END IF

   DEF INTEGER PUT_MSG( STRING M )
   ON ERROR GOTO 1550
   MLEN = LEN( M )
   MOVE TO # MAIL_CHANNEL , M = MLEN
   PUT # MAIL_CHANNEL, COUNT MLEN
   PUT_MSG = 0
   EXIT DEF

1550 RESUME 1555

1555 PUT_MSG = ERR
     END DEF

   DEF STRING GET_INPUT( INTEGER C )
   EOF = FALSE
   ON ERROR GOTO 1650
   GET # C
   R = RECOUNT
   MOVE FROM #C , TEMP$ = R
   GET_INPUT = TEMP$
   EXIT DEF

1650 RESUME 1655

1655 EOF = TRUE
     END DEF

   DEF STRING GET_MSG
   ON ERROR GOTO 1750
   GET # MAIL_CHANNEL
   R = RECOUNT
   MOVE FROM # MAIL_CHANNEL , TEMP$ = R
   GET_MSG = TEMP$
   LINK_ERR = 0
   EXIT DEF

1750 RESUME

1755 LINK_ERR = ERR
     END DEF

Mail_Net_Error:
  RESUME 1900

1900 PRINT &quot;%Network communications error.&quot;

Error_Done:

Mail_Done:
   IF Net_Link_Open THEN
     CLOSE MAIL_CHANNEL
   END IF

   END SUB
***********************************CUT HERE************************************
</pre>

</div>
</div>

</center>

<div align="center" class="texto-2-bold">
[ <a href="../../index.html" title="News">News</a> ]
[ <a href="../../" title="Paper Feed">Paper Feed</a> ]
[ <a href="../../issues/71/1.html" title="Issues">Issues</a> ]
[ <a href="../../authors.html" title="Authors">Authors</a> ]
[ <a href="../../archives/" title="Archives">Archives</a> ]
[ <a href="../../contact.html" title="Contact">Contact</a> ]
</div>

<div align="right" class="texto-1">© Copyleft 1985-2024, Phrack Magazine.</div>
</body>
</html>
